(()=>{(function(){"use strict";var _=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("k-inside",[e("k-view",{staticClass:"k-logbook-view"},[e("k-header",[t._v(" "+t._s(t.title)+" ")]),t.logfiles.length>0?e("section",{staticClass:"k-logbook-actions"},[e("k-grid",{attrs:{gutter:"medium"}},[e("k-column",{staticClass:"k-logbook-column-select",attrs:{width:"1/3"}},[e("k-select-field",{attrs:{options:t.logfilesOptions,label:"Logfile",name:"k-logbook__log-select",type:"select",icon:"angle-down"},on:{input:function(o){return t.fetch()}},model:{value:t.selectedLogfile,callback:function(o){t.selectedLogfile=o},expression:"selectedLogfile"}})],1)],1)],1):t._e(),this.total>0?e("section",{staticClass:"k-system-view-section"},[e("div",{staticClass:"k-system-info-box k-logbook-pane"},[t.isKirbyLogPluginLog?[e("table",[e("thead",[e("tr",[e("th",{staticClass:"column-timestamp"},[t._v("Timestamp")]),e("th",{staticClass:"column-level"},[t._v("Level")]),e("th",[t._v("Entry")])])]),e("tbody",t._l(t.pagedLogLines,function(o){return e("tr",{key:o},[e("td",{staticClass:"column-timestamp"},[e("pre",[t._v(t._s(o.timestamp))])]),e("td",{staticClass:"column-level"},[e("pre",[t._v(t._s(o.type))])]),e("td",[e("pre",[t._v(t._s(o.content))])])])}),0)])]:[e("ol",t._l(t.pagedLogLines,function(o,l){return e("li",{key:l},[e("pre",[t._v(t._s(o))])])}),0)]],2),e("div",{staticClass:"k-logbook-pane-caption"},[e("k-grid",{attrs:{gutter:"medium"}},[e("k-column",{staticClass:"k-logbook-column-pagination-summary",attrs:{width:"2/3"}},[t._v(" Showing "+t._s(t.pageStart+1)+" to "+t._s(t.pageEnd)+" from "+t._s(t.total)+" log entries ")]),e("k-column",{staticClass:"k-logbook-column-pagination",attrs:{width:"1/3"}},[e("k-pagination",{attrs:{details:!1,page:t.page,limit:t.limit,total:t.total},on:{paginate:t.paginate}})],1)],1)],1)]):t._e(),this.total==0&&t.logfiles.length!=0?e("section",{staticClass:"k-system-view-section"},[e("div",{staticClass:"k-system-info-box"},[e("k-empty",{attrs:{icon:"book"}},[t._v("Logfile is empty")])],1)]):t._e(),t.logfiles.length==0?e("section",{staticClass:"k-system-view-section"},[e("div",{staticClass:"k-system-info-box"},[e("k-empty",{attrs:{icon:"book"}},[t._v("No logfiles found")])],1)]):t._e()],1)],1)},p=[],C="";function h(t,s,e,o,l,c,g,b){var i=typeof t=="function"?t.options:t;s&&(i.render=s,i.staticRenderFns=e,i._compiled=!0),o&&(i.functional=!0),c&&(i._scopeId="data-v-"+c);var a;if(g?(a=function(n){n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!n&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(n=__VUE_SSR_CONTEXT__),l&&l.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(g)},i._ssrRegister=a):l&&(a=b?function(){l.call(this,(i.functional?this.parent:this).$root.$options.shadowRoot)}:l),a)if(i.functional){i._injectStyles=a;var y=i.render;i.render=function(L,f){return a.call(f),y(L,f)}}else{var u=i.beforeCreate;i.beforeCreate=u?[].concat(u,a):[a]}return{exports:t,options:i}}const d={name:"LogBookArea",props:["title","logfiles","selectedLogfile","hasKirbyLogPlugin","limit"],data(){return{page:1,logLines:[]}},methods:{fetch:function(){fetch("/kirbylogbook/"+this.selectedLogfile).then(t=>t.json()).then(t=>{this.page=1,Array.isArray(t)?this.logLines=t:this.logLines=Object.entries(t).map(s=>s[1])})},paginate:function({page:t,limit:s}){this.page=t,this.limit=s}},computed:{logfilesOptions:function(){return this.logfiles.map(t=>({value:t,text:t}))},isKirbyLogPluginLog:function(){if(this.logLines[0]==null)return!1;var t=["timestamp","type","content"];return this.hasKirbyLogPlugin&&JSON.stringify(Object.keys(this.logLines[0]))==JSON.stringify(t)},pagedLogLines:function(){return this.logLines.slice(this.pageStart,this.pageEnd)},total:function(){return this.logLines.length},pageStart:function(){return(this.page-1)*this.limit},pageEnd:function(){var t=(this.page-1)*this.limit+this.limit;return t>=this.total?this.total:t}},created(){this.fetch()}},r={};var m=h(d,_,p,!1,v,null,null,null);function v(t){for(let s in r)this[s]=r[s]}var k=function(){return m.exports}();window.panel.plugin("bvdputte/logbook",{components:{"k-logbook-area":k}})})();})();
